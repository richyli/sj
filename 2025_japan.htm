<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥æœ¬è²¡æ”¿æ‡¸å´–ï¼šé¦–ç›¸æ¨¡æ“¬å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', 'Noto Sans JP', sans-serif; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen font-sans text-slate-800 p-4 md:p-8 flex justify-center">

    <div class="max-w-3xl w-full bg-white shadow-xl rounded-xl overflow-hidden border border-slate-200 flex flex-col min-h-[800px]">
        
        <!-- Header -->
        <div class="bg-slate-900 p-6 text-white flex justify-between items-center shrink-0">
            <div>
                <h1 class="text-2xl font-bold flex items-center gap-2">
                    <i data-lucide="landmark" class="h-6 w-6"></i>
                    æ—¥æœ¬è²¡æ”¿æ‡¸å´–ï¼šé¦–ç›¸æ¨¡æ“¬å™¨
                </h1>
                <p class="text-slate-400 text-sm mt-1" id="turn-display">ç¬¬ 1 ä»»æœŸ / å…± 5 å¹´</p>
            </div>
            <div class="text-right">
                <div class="text-xs text-slate-400">ç•¶å‰é¦–ç›¸</div>
                <div class="font-bold">ä½  (YOU)</div>
            </div>
        </div>

        <!-- Dashboard Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-6 bg-slate-50 border-b border-slate-200 shrink-0">
            <!-- Debt -->
            <div id="card-debt" class="p-4 rounded-lg border bg-white border-slate-100 cursor-pointer transition-all hover:shadow-sm hover:border-blue-200 relative ring-2 ring-offset-1 ring-blue-500 shadow-md" onclick="selectMetric('debt')">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-bold text-slate-500 uppercase">åœ‹å‚µç¸½é¡</span>
                    <i data-lucide="shield-alert" class="h-4 w-4 text-red-500"></i>
                </div>
                <div id="val-debt" class="text-3xl font-bold text-slate-800">1286å…†</div>
                <div id="sub-debt" class="text-sm text-slate-400 mt-1">GDPæ¯” 216.1%</div>
                <div id="indicator-debt" class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 rotate-45"></div>
            </div>

            <!-- GDP -->
            <div id="card-gdp" class="p-4 rounded-lg border bg-white border-slate-100 cursor-pointer transition-all hover:shadow-sm hover:border-blue-200 relative" onclick="selectMetric('gdp')">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-bold text-slate-500 uppercase">åç›® GDP</span>
                    <i data-lucide="japanese-yen" class="h-4 w-4 text-blue-500"></i>
                </div>
                <div id="val-gdp" class="text-3xl font-bold text-slate-800">595å…†</div>
                <div id="sub-gdp" class="text-sm text-slate-400 mt-1">ç¶“æ¿Ÿè¦æ¨¡</div>
                <div id="indicator-gdp" class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 rotate-45 hidden"></div>
            </div>

            <!-- Interest Rate (ID Updated to match data key) -->
            <div id="card-interestRate" class="p-4 rounded-lg border bg-white border-slate-100 cursor-pointer transition-all hover:shadow-sm hover:border-blue-200 relative" onclick="selectMetric('interestRate')">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-bold text-slate-500 uppercase">å…¬å‚µæ®–åˆ©ç‡</span>
                    <i data-lucide="trending-up" class="h-4 w-4 text-orange-500"></i>
                </div>
                <div id="val-interestRate" class="text-3xl font-bold text-slate-800">0.9%</div>
                <div id="sub-interestRate" class="text-sm text-slate-400 mt-1">åˆ©æ¯è² æ“”</div>
                <div id="indicator-interestRate" class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 rotate-45 hidden"></div>
            </div>

            <!-- Approval -->
            <div id="card-approval" class="p-4 rounded-lg border bg-white border-slate-100 cursor-pointer transition-all hover:shadow-sm hover:border-blue-200 relative" onclick="selectMetric('approval')">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-bold text-slate-500 uppercase">å…§é–£æ”¯æŒç‡</span>
                    <i data-lucide="users" class="h-4 w-4 text-green-500"></i>
                </div>
                <div id="val-approval" class="text-3xl font-bold text-slate-800">45%</div>
                <div id="sub-approval" class="text-sm text-slate-400 mt-1">æ”¿æ²»è³‡æœ¬</div>
                <div id="indicator-approval" class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 rotate-45 hidden"></div>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="bg-white border-b border-slate-200 p-6 shrink-0 h-56">
            <div class="flex items-center gap-2 mb-4">
                <i data-lucide="activity" class="h-5 w-5 text-slate-500"></i>
                <h3 class="text-sm font-bold text-slate-500 uppercase">åŸ·æ”¿æ•¸æ“šèµ°å‹¢</h3>
                <span id="chart-label" class="text-xs text-slate-400 ml-auto">åœ‹å‚µ (å…†)</span>
            </div>
            <div class="h-32 w-full" id="chart-container">
                <!-- SVG Chart will be injected here -->
            </div>
        </div>

        <!-- Game Area (Dynamic Content) -->
        <div id="game-area" class="p-6 flex-grow flex flex-col justify-center">
            <!-- Content will be injected by JS -->
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- Data Definitions ---
        const INITIAL_STATE = {
            turn: 0,
            debt: 1286,
            gdp: 595,
            interestRate: 0.9,
            approval: 45,
            history: [],
            metricsHistory: [{ turn: 0, debt: 1286, gdp: 595, interestRate: 0.9, approval: 45 }],
            gameOver: false,
            endingType: null,
            message: ""
        };

        const SCENARIOS = [
            {
                id: 1,
                title: "ç¤¾æœƒä¿éšœè²»ç”¨çš„ç„¡åº•æ´",
                description: "é«˜é½¡åŒ–å°è‡´é†«ç™‚èˆ‡é¤Šè€é‡‘æ”¯å‡ºæš´å¢ã€‚å¿…é ˆæ±ºå®šå¦‚ä½•è™•ç†é€™ç­†é¾å¤§é–‹æ”¯ã€‚",
                statContext: "ç•¶å‰åœ‹å‚µï¼š1286 å…†æ—¥åœ“",
                choices: [
                    {
                        type: "å·¦æ´¾ (åŠ ç¨…)",
                        text: "ç¶­æŒç¦åˆ©ï¼Œå‘å¯Œäººèˆ‡ä¼æ¥­å¤§å¹…å¢ç¨…",
                        impact: "è€äººç¦åˆ©ä¿ä½äº†ï¼Œä½†ä¼æ¥­æšè¨€å‡ºèµ°ï¼Œè‚¡å¸‚å¤§è·Œã€‚",
                        tweet: { user: "åƒããŠçˆ¶ã•ã‚“ @salaryman_jp", content: "é‡‘æŒã¡å„ªé‡ã¯ã‚‚ã†çµ‚ã‚ã‚Šã ï¼ã§ã‚‚ä¼šç¤¾ãŒæµ·å¤–é€ƒã’ãŸã‚‰ä¿ºãŸã¡ã®ä»•äº‹ã©ã†ãªã‚‹ã®ï¼Ÿä¸å®‰... #å¯Œè£•å±¤å¢—ç¨ #ç¤¾ä¼šä¿éšœ" },
                        effect: (s) => ({ debt: s.debt - 10, approval: s.approval + 5, gdp: s.gdp - 10, history: [...s.history, "ç¬¬1å¹´ï¼šé¸æ“‡å‘å¯Œäººé–‹åˆ€ç¶­æŒç¦åˆ©ã€‚"] })
                    },
                    {
                        type: "ä¸­é–“ (èˆ‰å‚µ)",
                        text: "ç™¼è¡Œèµ¤å­—åœ‹å‚µï¼Œç¶­æŒç¾ç‹€",
                        impact: "å•é¡Œè¢«æ¨çµ¦äº†æœªä¾†ï¼Œå¤§å®¶æš«æ™‚ç›¸å®‰ç„¡äº‹ã€‚",
                        tweet: { user: "çµŒæ¸ˆãƒ‹ãƒ¥ãƒ¼ã‚¹bot @eco_bot", content: "ã¾ãŸèµ¤å­—å›½å‚µç™ºè¡Œã‹ã€‚å°†æ¥ã®ãƒ„ã‚±ãŒæ€–ã„ãªã€‚å­ä¾›ãŸã¡ã«è¬ã‚ŠãŸã„æ°—åˆ†ã€‚ #å›½å‚µ #å…ˆé€ã‚Š" },
                        effect: (s) => ({ debt: s.debt + 30, approval: s.approval + 2, history: [...s.history, "ç¬¬1å¹´ï¼šæ¡å–æ‹–å»¶æˆ°è¡“ï¼Œç¹¼çºŒç™¼å‚µã€‚"] })
                    },
                    {
                        type: "å³æ´¾ (å‰Šæ¸›)",
                        text: "å¾¹åº•å‰Šæ¸›ç¦åˆ©ï¼Œå¼·èª¿ã€è‡ªåŠ©ã€",
                        impact: "è²¡æ”¿ç²å¾—é¡¯è‘—æ”¹å–„ï¼Œä½†è€å¹´äººé™·å…¥è²§å›°ï¼Œç¤¾æœƒå‹•ç›ªã€‚",
                        tweet: { user: "æ€’ã‚Œã‚‹å¹´é‡‘å—çµ¦è€… @senior_voice", content: "å¹´é‡‘ã‚«ãƒƒãƒˆã¯æ­»æ´»å•é¡Œã ï¼ãšã£ã¨çœŸé¢ç›®ã«åƒã„ã¦ããŸã®ã«ã€ã“ã®ä»•æ‰“ã¡ã¯ãªã‚“ã ï¼è¨±ã›ãªã„ï¼ #å¹´é‡‘å‰Šæ¸› #æ£„æ°‘æ”¿ç­–" },
                        effect: (s) => ({ debt: s.debt - 25, approval: s.approval - 20, gdp: s.gdp + 5, history: [...s.history, "ç¬¬1å¹´ï¼šå¤§åˆ€é—Šæ–§ç ç¦åˆ©ã€‚"] })
                    }
                ]
            },
            {
                id: 2,
                title: "æ¶ˆè²»ç¨…å¢ç¨…çš„æ±ºæ–·",
                description: "IMF å¼·çƒˆå»ºè­°æé«˜æ¶ˆè²»ç¨…ä»¥å¥å…¨è²¡æ”¿ï¼Œä½†é€™å°‡ç›´æ¥è¡æ“Šå®¶åº­æ”¶æ”¯ã€‚",
                statContext: "æ°‘é–“æ¶ˆè²»ç–²è»Ÿ",
                choices: [
                    {
                        type: "å·¦æ´¾ (æ¸›ç¨…)",
                        text: "é™ä½æ¶ˆè²»ç¨…è‡³ 5%ï¼Œæ¸›è¼•åº¶æ°‘è² æ“”",
                        impact: "æ¶ˆè²»å¤§çˆ†ç™¼ï¼Œæ™¯æ°£å›æº«ï¼Œä½†è²¡æ”¿èµ¤å­—ç¬é–“æ“´å¤§ã€‚",
                        tweet: { user: "ä¸»å©¦ã®çŸ¥æµè¢‹ @mama_saver", content: "æ¸›ç¨ã‚­ã‚¿ãƒ¼ï¼ğŸ‰ ã“ã‚Œã§å°‘ã—ã¯ã‚¹ãƒ¼ãƒ‘ãƒ¼ã§è²·ã„ç‰©ã—ã‚„ã™ããªã‚‹ã‹ã‚‚ï¼ç·ç†ã‚ã‚ŠãŒã¨ã†ï¼ #æ¶ˆè²»ç¨æ¸›ç¨ #ç”Ÿæ´»è‹¦" },
                        effect: (s) => ({ debt: s.debt + 40, gdp: s.gdp + 25, approval: s.approval + 15, interestRate: s.interestRate + 0.1, history: [...s.history, "ç¬¬2å¹´ï¼šå¤§è†½æ¸›ç¨…åˆºæ¿€æ¶ˆè²»ã€‚"] })
                    },
                    {
                        type: "ä¸­é–“ (è£œè²¼)",
                        text: "ç¶­æŒ 10%ï¼Œç™¼æ”¾ä¸€æ¬¡æ€§ç¾é‡‘è£œè²¼",
                        impact: "ä¸ç—›ä¸ç™¢çš„æ”¿ç­–ï¼Œå‚µå‹™å°å¢ï¼Œç¶“æ¿Ÿç„¡æ˜é¡¯èµ·è‰²ã€‚",
                        tweet: { user: "å†·ç¬‘ç³» @cynical_jp", content: "çµ¦ä»˜é‡‘10ä¸‡å††ï¼Ÿç„¼ã‘çŸ³ã«æ°´ã ã‚ˆã€‚é¸æŒ™å¯¾ç­–ã®ãƒãƒ©ãƒã‚­ä¹™ã€‚ #çµ¦ä»˜é‡‘ #ãƒãƒ©ãƒã‚­" },
                        effect: (s) => ({ debt: s.debt + 10, gdp: s.gdp + 5, approval: s.approval + 5, history: [...s.history, "ç¬¬2å¹´ï¼šç™¼éŒ¢å®‰æ’«æ°‘å¿ƒã€‚"] })
                    },
                    {
                        type: "å³æ´¾ (å¢ç¨…)",
                        text: "å¢ç¨…è‡³ 15%ï¼Œå …æŒè²¡æ”¿ç´€å¾‹",
                        impact: "è²¡æ”¿é»‘å­—åŒ–ç›®æ¨™æ¥è¿‘ï¼Œä½†æ¶ˆè²»æ€¥å‡ï¼Œå•†åº—å€’é–‰æ½®ã€‚",
                        tweet: { user: "å•†åº—è¡—ã®æ‚²é³´ @shutter_street", content: "å¢—ç¨ãµã–ã‘ã‚“ãªï¼ã‚‚ã†åº—ç•³ã‚€ã—ã‹ãªã„ã‚ˆã€‚ãŠå®¢ã•ã‚“å…¨ç„¶æ¥ãªã„... #æ¶ˆè²»ç¨å¢—ç¨ #è²¡å‹™çœè§£ä½“" },
                        effect: (s) => ({ debt: s.debt - 30, gdp: s.gdp - 15, approval: s.approval - 15, history: [...s.history, "ç¬¬2å¹´ï¼šé ‚ä½å£“åŠ›å¢ç¨…ã€‚"] })
                    }
                ]
            },
            {
                id: 3,
                title: "æ—¥æœ¬éŠ€è¡Œ (å¤®è¡Œ) çš„åˆ©ç‡å›°å¢ƒ",
                description: "é€šè†¨èˆ‡æ—¥åœ“è²¶å€¼é›™é‡å¤¾æ“Šã€‚å¤®è¡Œç¸½è£è«‹ç¤ºä¸‹ä¸€æ­¥è²¨å¹£æ”¿ç­–æ–¹å‘ã€‚",
                statContext: "ç•¶å‰åˆ©ç‡ï¼š0.9% (é€æ¼¸ä¸Šå‡ä¸­)",
                choices: [
                    {
                        type: "å·¦æ´¾ (å¯¬é¬†)",
                        text: "å …æŒè¶…å¯¬é¬†è²¨å¹£æ”¿ç­–ï¼Œæ”¿åºœæ“´å¤§æ”¯å‡º",
                        impact: "æ—¥åœ“è²¶ç ´ 170ï¼Œç‰©åƒ¹é£›æ¼²ï¼Œä½†ä¼æ¥­å‡ºå£ç²åˆ©å‰µæ–°é«˜ã€‚",
                        tweet: { user: "ç‰©ä¾¡é«˜é¨°è‹¦ã—ã„ @inflation_hell", content: "å††å®‰ãŒæ­¢ã¾ã‚‰ãªã„ï¼ã‚¬ã‚½ãƒªãƒ³é«˜ã™ãï¼ã‚¹ãƒ¼ãƒ‘ãƒ¼ã®åµã‚‚å€¤ä¸ŠãŒã‚Š...ç”Ÿæ´»ã§ããªã„ã‚ˆğŸ˜­ #å††å®‰ #ç‰©ä¾¡é«˜" },
                        effect: (s) => ({ interestRate: s.interestRate - 0.2, debt: s.debt + 20, gdp: s.gdp + 10, approval: s.approval - 10, history: [...s.history, "ç¬¬3å¹´ï¼šç„¡è¦–é€šè†¨å …æŒå¯¬é¬†ã€‚"] })
                    },
                    {
                        type: "ä¸­é–“ (æ¼¸é€²)",
                        text: "ç·©æ­¥å‡æ¯ï¼Œå°‹æ±‚è»Ÿè‘—é™¸",
                        impact: "å¸‚å ´åæ‡‰å¹³éœï¼Œä½†åˆ©æ¯æ”¯å‡ºå£“åŠ›é–‹å§‹ç·©æ…¢æµ®ç¾ã€‚",
                        tweet: { user: "ãƒã‚¤ãƒ›ãƒ¼ãƒ ãƒ‘ãƒ‘ @loan_worrier", content: "ä½å®…ãƒ­ãƒ¼ãƒ³ã®é‡‘åˆ©ãŒä¸ŠãŒã‚Šå§‹ã‚ãŸ...å¤‰å‹•é‡‘åˆ©ã§å€Ÿã‚Šã¦ã‚‹ã‹ã‚‰ãƒã‚¸ã§æ€–ã„ã€‚ #é‡‘åˆ©å¼•ãä¸Šã’ #ä½å®…ãƒ­ãƒ¼ãƒ³" },
                        effect: (s) => ({ interestRate: s.interestRate + 0.5, debt: s.debt + (s.debt * 0.01), approval: s.approval - 5, history: [...s.history, "ç¬¬3å¹´ï¼šå°å¿ƒç¿¼ç¿¼åœ°å‡æ¯ã€‚"] })
                    },
                    {
                        type: "å³æ´¾ (ç·Šç¸®)",
                        text: "æ¿€é€²å‡æ¯ï¼Œå¾¹åº•æ‰“æ“Šé€šè†¨",
                        impact: "é€šè†¨æ¶ˆå¤±ï¼Œæ—¥åœ“å¼·å‹¢å›æ­¸ã€‚ä½†åœ‹å‚µåˆ©æ¯æ”¯å‡ºç¬é–“å¼•çˆ†é ç®—å±æ©Ÿã€‚",
                        tweet: { user: "æ ªãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼X @market_crash", content: "é‡‘åˆ©æ€¥é¨°ã§æ ªä¾¡æš´è½ï¼ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼ç™ºå‹•ï¼æ—¥æœ¬çµŒæ¸ˆçµ‚ã‚ã£ãŸãª...ğŸ“‰ #æ—¥çµŒå¹³å‡ #ãƒ–ãƒ©ãƒƒã‚¯ãƒãƒ³ãƒ‡ãƒ¼" },
                        effect: (s) => ({ interestRate: s.interestRate + 2.0, debt: s.debt + (s.debt * 0.03), gdp: s.gdp - 10, approval: s.approval - 10, history: [...s.history, "ç¬¬3å¹´ï¼šé·¹æ´¾å‡æ¯ä¼‘å…‹ç™‚æ³•ã€‚"] })
                    }
                ]
            },
            {
                id: 4,
                title: "åœ°ç·£æ”¿æ²»èˆ‡é˜²è¡›è²»",
                description: "å€åŸŸç·Šå¼µå±€å‹¢å‡æº«ã€‚ç¾åœ‹è¦æ±‚æ—¥æœ¬å¤§å¹…å¢åŠ é˜²è¡›é ç®—ã€‚",
                statContext: "é˜²è¡›é ç®—éœ€æ±‚è¿«åˆ‡",
                choices: [
                    {
                        type: "å·¦æ´¾ (å’Œå¹³)",
                        text: "æ‹’çµ•æ“´è»ï¼Œé ç®—è½‰ç”¨æ–¼æ°‘ç”Ÿèˆ‡å¤–äº¤",
                        impact: "ç›Ÿåœ‹é—œä¿‚ç·Šå¼µï¼Œä½†åœ‹å…§ç¦åˆ©é ç®—å……è£•ã€‚",
                        tweet: { user: "ãƒ”ãƒ¼ã‚¹ã‚¦ã‚©ãƒ¼ã‚«ãƒ¼ @no_war_jp", content: "å¹³å’Œæ†²æ³•ã‚’å®ˆã‚ã†ï¼è»æ‹¡åå¯¾ï¼å¤–äº¤åŠªåŠ›ã§å¹³å’Œã‚’ä½œã‚‹ã¹ãã ğŸ•Šï¸ #æ†²æ³•9æ¡ #å¹³å’Œ" },
                        effect: (s) => ({ debt: s.debt - 5, approval: s.approval + 5, gdp: s.gdp + 5, history: [...s.history, "ç¬¬4å¹´ï¼šé¸æ“‡å’Œå¹³æ†²æ³•è·¯ç·šã€‚"] })
                    },
                    {
                        type: "ä¸­é–“ (æŠ˜è¡·)",
                        text: "å°å¹…å¢åŠ é ç®—ï¼Œé€éå¢ç¨…ç±Œæª",
                        impact: "å„æ–¹éƒ½ä¸æ»¿æ„ï¼Œä½†ç¶­æŒäº†æœ€ä½é™åº¦çš„åœ‹é˜²èˆ‡è²¡æ”¿ã€‚",
                        tweet: { user: "æ”¿æ²»ã‚¦ã‚©ãƒƒãƒãƒ£ãƒ¼ @seiji_watch", content: "é˜²è¡›è²»ã®ãŸã‚ã«å¢—ç¨ï¼Ÿå¾©èˆˆç‰¹åˆ¥æ‰€å¾—ç¨ã®è»¢ç”¨ã¨ã‹æ„å‘³ã‚ã‹ã‚‰ã‚“ã€‚ç´å¾—ã„ã‹ãªã„ãªã€‚ #é˜²è¡›å¢—ç¨ #å²¸ç”°æ”¿æ¨©" },
                        effect: (s) => ({ gdp: s.gdp - 5, approval: s.approval - 5, history: [...s.history, "ç¬¬4å¹´ï¼šé€éå¢ç¨…å°å¹…æ“´è»ã€‚"] })
                    },
                    {
                        type: "å³æ´¾ (å¼·å…µ)",
                        text: "ç™¼è¡Œã€é˜²è¡›åœ‹å‚µã€ï¼Œè»è²»ç¿»å€",
                        impact: "è»å·¥ç”¢æ¥­å¤§çˆ†ç™¼ï¼Œä½†åœ‹å®¶è²¡æ”¿èµ¤å­—å†å‰µæ–°é«˜ã€‚",
                        tweet: { user: "æ†‚å›½ã®å£« @patriot_jp", content: "å›½ã‚’å®ˆã‚‹ã«ã¯é‡‘ãŒã‹ã‹ã‚‹ã€‚ãƒŸã‚µã‚¤ãƒ«è²·ã‚ãªãã‚ƒå›½ãŒæ»…ã¶ãã€‚å›½å‚µç™ºè¡Œã¯ä»•æ–¹ãªã„é¸æŠã ã€‚ #é˜²è¡›è²» #å›½é˜²" },
                        effect: (s) => ({ debt: s.debt + 50, gdp: s.gdp + 15, interestRate: s.interestRate + 0.4, approval: s.approval + 5, history: [...s.history, "ç¬¬4å¹´ï¼šèˆ‰å‚µå¼·å…µã€‚"] })
                    }
                ]
            },
            {
                id: 5,
                title: "æœ€å¾Œçš„è³­æ³¨ï¼šäººå£å±æ©Ÿèˆ‡ç§»æ°‘",
                description: "å‹å‹•åŠ›æ¯ç«­ï¼Œé„‰æ‘é¢è‡¨æ¶ˆæ»…ã€‚å¿…é ˆæ±ºå®šåœ‹å®¶çš„äººå£æ”¿ç­–æ–¹å‘ã€‚",
                statContext: "å‹å‹•åŠ›ç¼ºå£ï¼šæ¥µåº¦åš´é‡",
                choices: [
                    {
                        type: "å·¦æ´¾ (é–‹æ”¾)",
                        text: "å…¨é¢é–‹æ”¾ç§»æ°‘ï¼Œçµ¦äºˆæ°¸ä½æ¬Š",
                        impact: "ç¶“æ¿Ÿæ³¨å…¥å¼·å¤§æ´»æ°´ï¼ŒGDP é£›èºï¼Œä½†ç¤¾æœƒæ–‡åŒ–è¡çªåŠ åŠ‡ã€‚",
                        tweet: { user: "åœ°å…ƒä½æ°‘ @local_voice", content: "æœ€è¿‘ã€ã‚³ãƒ³ãƒ“ãƒ‹ã‚‚å·¥å ´ã‚‚å¤–å›½äººã°ã‹ã‚Šã ã€‚è¡—ã®é›°å›²æ°—ãŒå¤‰ã‚ã£ãŸãª...æ²»å®‰å¤§ä¸ˆå¤«ã‹ãªï¼Ÿ #ç§»æ°‘æ”¿ç­– #å¤šæ–‡åŒ–å…±ç”Ÿ" },
                        effect: (s) => ({ gdp: s.gdp + 40, debt: s.debt - 15, approval: s.approval - 20, history: [...s.history, "ç¬¬5å¹´ï¼šåœ‹é–€å¤§é–‹ï¼Œè½‰å‹ç§»æ°‘åœ‹å®¶ã€‚"] })
                    },
                    {
                        type: "ä¸­é–“ (å—é™)",
                        text: "æ“´å¤§æŠ€èƒ½å¯¦ç¿’ç”Ÿï¼Œé™åˆ¶å±…ç•™å¹´é™",
                        impact: "ç²å¾—äº†å»‰åƒ¹å‹å‹•åŠ›ï¼Œä½†è¢«åœ‹éš›äººæ¬Šçµ„ç¹”æ‰¹è©•ï¼Œä¸”å‹å·¥æµå¤±å¿«ã€‚",
                        tweet: { user: "ä¸­å°ä¼æ¥­ã‚ªãƒ¤ã‚¸ @sme_boss", content: "æŠ€èƒ½å®Ÿç¿’ç”Ÿé ¼ã¿ã§ã„ã„ã®ã‹ï¼Ÿå½¼ã‚‰ã‚‚æœ€è¿‘ã¯è³ƒé‡‘ã®é«˜ã„ä»–ã®å›½ã«è¡Œã£ã¡ã‚ƒã†ã‚ˆã€‚æ ¹æœ¬çš„ãªè§£æ±ºã«ãªã£ã¦ãªã„ã€‚ #äººæ‰‹ä¸è¶³ #å¤–å›½äººåŠ´åƒè€…" },
                        effect: (s) => ({ gdp: s.gdp + 10, debt: s.debt - 5, approval: s.approval - 5, history: [...s.history, "ç¬¬5å¹´ï¼šä¾è³´çŸ­æœŸå¤–ç±å‹åŠ›ã€‚"] })
                    },
                    {
                        type: "å³æ´¾ (å°é–‰)",
                        text: "å …æŒå–®ä¸€æ°‘æ—ï¼Œå…¨åŠ›æŠ•è³‡ AI è‡ªå‹•åŒ–",
                        impact: "ç¤¾æœƒæ²»å®‰è‰¯å¥½ï¼Œä½†ä¸­å°ä¼æ¥­å› ç¼ºå·¥å¤§é‡å€’é–‰ã€‚",
                        tweet: { user: "æŠ€è¡“ç«‹å›½æ—¥æœ¬ @tech_japan", content: "ç§»æ°‘ã«é ¼ã‚‹ãªï¼ãƒ­ãƒœãƒƒãƒˆã¨AIã§ä¹—ã‚Šåˆ‡ã‚‹ãï¼ã“ã‚Œã“ããŒæ—¥æœ¬æµã®ç”Ÿãæ®‹ã‚Šæ–¹ã ğŸ‡¯ğŸ‡µ #è‡ªå‹•åŒ– #AI" },
                        effect: (s) => ({ gdp: s.gdp - 10, debt: s.debt + 20, approval: s.approval + 10, history: [...s.history, "ç¬¬5å¹´ï¼šæ‹’çµ•ç§»æ°‘ï¼ŒæŠ•è³‡è‡ªå‹•åŒ–ã€‚"] })
                    }
                ]
            }
        ];

        // --- State Management ---
        let gameState = { ...INITIAL_STATE };
        let selectedMetric = 'debt'; // debt, gdp, interestRate, approval
        let currentChoiceImpact = "";
        let currentChoiceTweet = null;

        // --- Core Functions ---

        function init() {
            lucide.createIcons();
            renderDashboard();
            renderGameArea();
            renderChart();
        }

        function selectMetric(metric) {
            selectedMetric = metric;
            
            // Update UI styles
            ['debt', 'gdp', 'interestRate', 'approval'].forEach(m => {
                const el = document.getElementById(`card-${m}`);
                const indicator = document.getElementById(`indicator-${m}`);
                
                if (m === metric) {
                    el.classList.add('ring-2', 'ring-offset-1', 'ring-blue-500', 'shadow-md');
                    el.classList.remove('hover:shadow-sm', 'hover:border-blue-200');
                    indicator.classList.remove('hidden');
                } else {
                    el.classList.remove('ring-2', 'ring-offset-1', 'ring-blue-500', 'shadow-md');
                    el.classList.add('hover:shadow-sm', 'hover:border-blue-200');
                    indicator.classList.add('hidden');
                }
            });
            
            renderChart();
        }

        function renderDashboard() {
            // Update Turn
            const turnText = gameState.turn > 5 ? 5 : gameState.turn + 1;
            document.getElementById('turn-display').innerText = `ç¬¬ ${turnText} ä»»æœŸ / å…± 5 å¹´`;

            // Update Metrics
            const debtRatio = gameState.gdp > 0 ? ((gameState.debt / gameState.gdp) * 100).toFixed(1) : "---";
            
            updateCard('debt', `${gameState.debt.toFixed(0)}å…†`, `GDPæ¯” ${debtRatio}%`, gameState.debt > 1400);
            updateCard('gdp', `${gameState.gdp.toFixed(0)}å…†`, `ç¶“æ¿Ÿè¦æ¨¡`, gameState.gdp < 550);
            updateCard('interestRate', `${gameState.interestRate.toFixed(1)}%`, `åˆ©æ¯è² æ“”`, gameState.interestRate > 2.0); // ID fixed here
            updateCard('approval', `${gameState.approval.toFixed(0)}%`, `æ”¿æ²»è³‡æœ¬`, gameState.approval < 30);
        }

        function updateCard(id, val, sub, isBad) {
            const valEl = document.getElementById(`val-${id}`);
            valEl.innerText = val;
            valEl.className = `text-3xl font-bold ${isBad ? 'text-red-700' : 'text-slate-800'}`;
            document.getElementById(`sub-${id}`).innerText = sub;
            
            const cardEl = document.getElementById(`card-${id}`);
            if (isBad) {
                cardEl.classList.add('bg-red-50', 'border-red-200');
                cardEl.classList.remove('bg-white', 'border-slate-100');
            } else {
                cardEl.classList.add('bg-white', 'border-slate-100');
                cardEl.classList.remove('bg-red-50', 'border-red-200');
            }
        }

        function renderGameArea() {
            const area = document.getElementById('game-area');
            area.innerHTML = '';

            // 0. Start Screen
            if (gameState.turn === 0 && !gameState.gameOver) {
                area.innerHTML = `
                    <div class="text-center space-y-6 max-w-lg mx-auto">
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 text-left">
                            <p class="font-bold text-red-800">è²¡æ”¿çœå ±å‘Šï¼š</p>
                            <p class="text-red-700 text-sm mt-1">ç¸½ç†ï¼Œæˆ‘åœ‹çš„å‚µå‹™è¦æ¨¡å·²é”åˆ°å±éšªæ°´åŸŸã€‚å¦‚æœä¸é€²è¡Œæ”¹é©ï¼Œåˆ©æ¯æ”¯ä»˜å°‡åœ¨æ•¸å¹´å…§åå™¬æ‰€æœ‰é ç®—ã€‚ä½†ä»»ä½•æ”¹é©éƒ½æœƒå¾—ç½ªé¸æ°‘æˆ–æ‰¼æ®ºç¶“æ¿Ÿã€‚</p>
                        </div>
                        <button onclick="startGame()" class="bg-slate-900 hover:bg-slate-800 text-white px-8 py-3 rounded-lg font-bold transition-all w-full md:w-auto shadow-lg">
                            å®£èª“å°±è·ï¼Œé–‹å§‹æ±ºç­–
                        </button>
                    </div>
                `;
                return;
            }

            // Game Over Screen
            if (gameState.gameOver) {
                const endingColors = {
                    'bankruptcy': 'text-red-600',
                    'growth': 'text-green-600',
                    'neutral': 'text-slate-700',
                    'inflation': 'text-orange-600'
                };
                const finalRatio = ((gameState.debt / gameState.gdp) * 100).toFixed(1);

                area.innerHTML = `
                    <div class="space-y-6 text-center animate-fade-in max-w-lg mx-auto">
                        <h2 class="text-3xl font-black ${endingColors[gameState.endingType]}">
                            ${getEndingTitle(gameState.endingType)}
                        </h2>
                        
                        <div class="bg-slate-50 p-6 rounded-lg text-left space-y-4 border border-slate-200">
                            <p class="text-lg font-medium leading-relaxed">${gameState.message}</p>
                            <div class="border-t border-slate-200 pt-4">
                                <h4 class="font-bold text-sm text-slate-400 mb-2">åŸ·æ”¿æ­·å²è»Œè·¡ï¼š</h4>
                                <ul class="text-sm space-y-1 text-slate-600">
                                    ${gameState.history.map(h => `<li>â€¢ ${h}</li>`).join('')}
                                </ul>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-slate-100 p-2 rounded font-mono">æœ€çµ‚å‚µå‹™æ¯”ï¼š${finalRatio}%</div>
                            <div class="bg-slate-100 p-2 rounded font-mono">æœ€çµ‚åˆ©ç‡ï¼š${gameState.interestRate.toFixed(1)}%</div>
                        </div>

                        <button onclick="restartGame()" class="bg-slate-900 hover:bg-slate-800 text-white px-8 py-3 rounded-lg font-bold transition-all shadow-lg">
                            é‡æ–°æŒ‘æˆ°
                        </button>
                    </div>
                `;
                return;
            }

            // Scenario Screen
            if (currentChoiceImpact) {
                // Showing Result
                area.innerHTML = `
                    <div class="space-y-6 text-center max-w-lg mx-auto">
                        <div class="inline-flex items-center justify-center p-3 bg-green-100 text-green-700 rounded-full mb-2 animate-bounce">
                            <i data-lucide="arrow-right" class="h-6 w-6"></i>
                        </div>
                        <h3 class="text-xl font-bold">æ±ºç­–å¾Œæœ</h3>
                        <p class="text-slate-600 text-lg border-l-4 border-slate-300 pl-4 py-2 bg-slate-50 text-left rounded-r">
                            ${currentChoiceImpact}
                        </p>

                        <!-- Simulated Tweet -->
                        <div class="text-left mt-4 bg-white border border-slate-200 rounded-xl p-4 shadow-sm">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-xs font-bold text-slate-500">
                                    ${currentChoiceTweet.user.charAt(0)}
                                </div>
                                <div class="text-sm">
                                    <span class="font-bold text-slate-900">${currentChoiceTweet.user.split('@')[0]}</span>
                                    <span class="text-slate-400 text-xs">${currentChoiceTweet.user.includes('@') ? '@' + currentChoiceTweet.user.split('@')[1] : ''}</span>
                                </div>
                                <i data-lucide="twitter" class="h-3 w-3 text-blue-400 ml-auto"></i>
                            </div>
                            <p class="text-sm text-slate-700 leading-snug">
                                ${currentChoiceTweet.content}
                            </p>
                            <div class="text-xs text-slate-400 mt-2">10:42 AM Â· Twitter for Japan</div>
                        </div>

                        <div class="text-xs text-slate-400 mt-2">
                            æ³¨æ„ï¼šåœ‹å‚µåˆ©æ¯æœƒéš¨è‘—æ™‚é–“è‡ªå‹•æ»¾å‹•ç´¯ç©ã€‚
                        </div>
                        <button onclick="nextTurn()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-bold w-full shadow-md transition-colors">
                            é€²å…¥ä¸‹ä¸€å¹´åº¦
                        </button>
                    </div>
                `;
                lucide.createIcons();
            } else {
                // Showing Choices
                const scenario = SCENARIOS[gameState.turn - 1];
                area.innerHTML = `
                    <div class="space-y-6">
                        <div class="flex items-center gap-2 text-red-600 font-bold uppercase tracking-wider text-sm">
                            <i data-lucide="alert-triangle" class="h-4 w-4"></i> å±æ©Ÿæ±ºç­– #${gameState.turn}
                        </div>
                        
                        <h2 class="text-2xl font-bold text-slate-900">
                            ${scenario.title}
                        </h2>
                        
                        <p class="text-slate-600 leading-relaxed">
                            ${scenario.description}
                        </p>

                        <div class="bg-blue-50 text-blue-800 px-4 py-2 rounded text-sm font-medium inline-block mb-2">
                            é—œéµæ•¸æ“šèƒŒæ™¯ï¼š${scenario.statContext}
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-2">
                            ${scenario.choices.map((choice, idx) => {
                                const styles = idx === 0 ? 'bg-red-50 border-red-200 hover:border-red-500 hover:bg-red-100' : 
                                               idx === 1 ? 'bg-slate-50 border-slate-200 hover:border-slate-500 hover:bg-slate-100' : 
                                               'bg-blue-50 border-blue-200 hover:border-blue-500 hover:bg-blue-100';
                                const badge = idx === 0 ? 'bg-red-200 text-red-800' : 
                                              idx === 1 ? 'bg-slate-200 text-slate-800' : 
                                              'bg-blue-200 text-blue-800';
                                
                                return `
                                <button onclick="handleChoice(${idx})" class="group relative flex flex-col items-start p-4 border-2 rounded-xl transition-all hover:shadow-lg text-left h-full ${styles}">
                                    <div class="text-xs font-black uppercase mb-1 px-2 py-0.5 rounded ${badge}">
                                        ${choice.type}
                                    </div>
                                    <span class="font-bold text-base mb-2 leading-tight text-slate-800">${choice.text}</span>
                                    <span class="mt-auto text-xs text-slate-500 pt-2 border-t border-slate-200/50 w-full">
                                       é»æ“ŠåŸ·è¡Œ
                                    </span>
                                </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
                lucide.createIcons();
            }
        }

        // --- Game Logic ---

        function startGame() {
            gameState.turn = 1;
            renderDashboard();
            renderGameArea();
        }

        function handleChoice(choiceIdx) {
            const scenario = SCENARIOS[gameState.turn - 1];
            const choice = scenario.choices[choiceIdx];
            
            // Apply effects
            const changes = choice.effect(gameState);
            
            // Interest Compound Logic
            const interestBurden = (gameState.debt * gameState.interestRate * 0.01) * 2; // Exaggerated for gameplay
            const newDebt = (changes.debt || gameState.debt) + interestBurden;

            // Update State
            gameState = {
                ...gameState,
                ...changes,
                debt: newDebt
            };

            // Record History
            const nextTurn = gameState.turn + 1;
            gameState.metricsHistory.push({
                turn: nextTurn,
                debt: gameState.debt,
                gdp: gameState.gdp,
                interestRate: gameState.interestRate,
                approval: gameState.approval
            });

            // Set UI for Result
            currentChoiceImpact = choice.impact + ` (åˆ©æ¯è² æ“”å¢åŠ : ${interestBurden.toFixed(1)}å…†)`;
            currentChoiceTweet = choice.tweet;

            renderDashboard();
            renderGameArea();
            renderChart();
        }

        function nextTurn() {
            gameState.turn += 1;
            currentChoiceImpact = "";
            currentChoiceTweet = null;
            
            if (gameState.turn > 5) {
                determineEnding();
            }
            
            renderDashboard();
            renderGameArea();
        }

        function determineEnding() {
            const finalRatio = (gameState.debt / gameState.gdp) * 100;
            gameState.gameOver = true;

            if (gameState.debt > 1600 || gameState.interestRate > 3.5) {
                gameState.endingType = 'bankruptcy';
                gameState.message = "ã€åœ‹å®¶ç ´ç”¢ã€‘åˆ©æ¯æ”¯å‡ºè¶…éç¨…æ”¶ï¼Œæ—¥æœ¬å…¬å‚µé•ç´„ã€‚æ—¥åœ“æˆç‚ºå»¢ç´™ï¼ŒIMF æ¥ç®¡è²¡æ”¿ã€‚ä½ æ˜¯æ­·å²çš„ç½ªäººã€‚";
            } else if (finalRatio < 240 && gameState.gdp > 600) {
                gameState.endingType = 'growth';
                gameState.message = "ã€å¥‡è¹Ÿå¾©ç”¦ã€‘é€éç—›è‹¦çš„æ”¹é©èˆ‡æˆé•·ï¼Œä½ æˆåŠŸæ§åˆ¶äº†å‚µå‹™æ¯”ä¾‹ã€‚é›–ç„¶æ”¯æŒç‡ä¸é«˜ï¼Œä½†ä½ æ‹¯æ•‘äº†æ—¥æœ¬çš„æœªä¾†ã€‚";
            } else if (gameState.approval < 15) {
                gameState.endingType = 'neutral';
                gameState.message = "ã€å…§é–£ç¸½è¾­ã€‘é›–ç„¶è²¡æ”¿å°šå¯ï¼Œä½†ä½ çš„æ”¿ç­–å¼•ç™¼çœ¾æ€’ã€‚ä½ åœ¨ä»»æœŸçµæŸå‰è¢«è¿«ä¸‹å°ï¼Œå•é¡Œç•™çµ¦äº†ä¸‹ä¸€ä»»ã€‚";
            } else {
                gameState.endingType = 'inflation';
                gameState.message = "ã€æº«æ°´ç…®é’è›™ã€‘æ—¥æœ¬åœ¨ä½ çš„å¸¶é ˜ä¸‹ï¼Œå‹‰å¼·ç¶­æŒç¾ç‹€ã€‚å‚µå‹™æŒçºŒç´¯ç©ï¼Œè¡°é€€ç·©æ…¢é€²è¡Œã€‚é€™æ˜¯ä¸€å€‹å®‰éœçš„é»ƒæ˜ã€‚";
            }
        }

        function getEndingTitle(type) {
            switch(type) {
                case 'bankruptcy': return 'GAME OVER: åœ‹å®¶ç ´ç”¢';
                case 'growth': return 'VICTORY: è²¡æ”¿é‡å»ºæˆåŠŸ';
                case 'neutral': return 'çµå±€ï¼šå…§é–£ç¸½è¾­';
                default: return 'çµå±€ï¼šæœªä¾†çš„è¿·éœ§';
            }
        }

        function restartGame() {
            gameState = { ...INITIAL_STATE, metricsHistory: [{ turn: 0, debt: 1286, gdp: 595, interestRate: 0.9, approval: 45 }] };
            currentChoiceImpact = "";
            currentChoiceTweet = null;
            startGame();
        }

        // --- Chart Logic (SVG) ---
        function renderChart() {
            const container = document.getElementById('chart-container');
            const data = gameState.metricsHistory;
            const dataKey = selectedMetric;
            
            // Config
            const labels = {
                'debt': { color: '#ef4444', name: 'åœ‹å‚µ' },
                'gdp': { color: '#3b82f6', name: 'GDP' },
                'interestRate': { color: '#f97316', name: 'åˆ©ç‡' },
                'approval': { color: '#22c55e', name: 'æ”¯æŒç‡' }
            };
            const config = labels[dataKey];
            
            // Update Label text
            const firstVal = data[0][dataKey];
            const lastVal = data[data.length-1][dataKey];
            document.getElementById('chart-label').innerText = `${config.name}: ${firstVal.toFixed(1)} â†’ ${lastVal.toFixed(1)}`;

            // Calculate Scales
            const values = data.map(d => d[dataKey]);
            const min = Math.min(...values);
            const max = Math.max(...values);
            const range = max - min || 1; // prevent divide by zero
            
            const width = 100;
            const height = 50;
            const padding = 5;

            // Generate Points
            const points = data.map((d, i) => {
                const x = (i / 5) * (width - padding * 2) + padding; // 0 to 5 turns
                const y = height - padding - ((d[dataKey] - min) / range) * (height - padding * 2);
                return `${x},${y}`;
            }).join(' ');

            // Generate Dots
            const dots = data.map((d, i) => {
                const x = (i / 5) * (width - padding * 2) + padding;
                const y = height - padding - ((d[dataKey] - min) / range) * (height - padding * 2);
                return `<circle cx="${x}" cy="${y}" r="1.5" fill="white" stroke="${config.color}" stroke-width="1" />`;
            }).join('');

            // SVG Template
            const svg = `
                <svg viewBox="0 0 ${width} ${height}" class="w-full h-full overflow-visible" preserveAspectRatio="none">
                    <line x1="${padding}" y1="${padding}" x2="${width-padding}" y2="${padding}" stroke="#e2e8f0" stroke-width="0.5" stroke-dasharray="2" />
                    <line x1="${padding}" y1="${height-padding}" x2="${width-padding}" y2="${height-padding}" stroke="#e2e8f0" stroke-width="0.5" stroke-dasharray="2" />
                    
                    <polyline
                        fill="none"
                        stroke="${config.color}"
                        stroke-width="2"
                        points="${points}"
                        vector-effect="non-scaling-stroke" 
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                    ${dots}
                </svg>
                <div class="flex justify-between text-[10px] text-slate-400 mt-1 px-1 font-mono">
                    <span>Start</span>
                    <span>Y1</span>
                    <span>Y2</span>
                    <span>Y3</span>
                    <span>Y4</span>
                    <span>End</span>
                </div>
            `;
            
            container.innerHTML = svg;
        }

        // Initialize
        init();

    </script>
</body>
</html>
