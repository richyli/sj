<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¹æ˜Ÿè½é»å¤§æŒ‘æˆ°</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        /* Custom Animations */
        @keyframes bounce {
            0%, 100% { transform: translateY(-10%); animation-timing-function: cubic-bezier(0.8,0,1,1); }
            50% { transform: translateY(0); animation-timing-function: cubic-bezier(0,0,0.2,1); }
        }
        .animate-bounce { animation: bounce 1s infinite; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.5s ease-in-out; }
    </style>
</head>
<body class="bg-slate-100 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons Components (SVG) ---
        const Trophy = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
        );
        const Swords = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" y1="19" x2="19" y2="13"/><line x1="16" y1="16" x2="20" y2="20"/><line x1="19" y1="21" x2="21" y2="19"/><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"/><line x1="16" y1="3" x2="21" y2="8"/><line x1="4" y1="20" x2="8" y2="16"/><line x1="3" y1="21" x2="5" y2="19"/></svg>
        );
        const RefreshCcw = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
        );
        const GraduationCap = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
        );
        const CheckCircle = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        );
        const XCircle = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
        );
        const Star = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        );
        const ListOrdered = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="10" y1="6" x2="21" y2="6"/><line x1="10" y1="12" x2="21" y2="12"/><line x1="10" y1="18" x2="21" y2="18"/><path d="M4 6h1v4"/><path d="M4 10h2"/><path d="M6 18H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
        );

        // --- Data ---
        const RAW_DATA = [
            // --- é ‚å°–å€é–“ ---
            { id: 'd02', school: 'åœ‹ç«‹è‡ºç£å¤§å­¸', dept: 'æ³•å¾‹å­¸ç³»', percent: 1.1, tag: 'å‰ 1%' },
            { id: 'd03', school: 'åœ‹ç«‹æ¸…è¯å¤§å­¸', dept: 'è³‡è¨Šå·¥ç¨‹å­¸ç³»', percent: 1.5, tag: 'ç´„ å‰ 1.5%' },
            { id: 'd04', school: 'åœ‹ç«‹é™½æ˜äº¤å¤§', dept: 'é›»æ©Ÿå·¥ç¨‹å­¸ç³»', percent: 1.6, tag: 'ç´„ å‰ 1.5-2%' },
            { id: 'd01', school: 'åœ‹ç«‹æ”¿æ²»å¤§å­¸', dept: 'è²¡å‹™ç®¡ç†å­¸ç³»', percent: 2.0, tag: 'ç´„ å‰ 2%' },
            { id: 'd05', school: 'åœ‹ç«‹æˆåŠŸå¤§å­¸', dept: 'é›»æ©Ÿå·¥ç¨‹å­¸ç³»', percent: 2.0, tag: 'ç´„ å‰ 2%' },
            { id: 'd06', school: 'åœ‹ç«‹æ”¿æ²»å¤§å­¸', dept: 'é¢¨éšªç®¡ç†èˆ‡ä¿éšª', percent: 3.0, tag: 'ç´„ å‰ 3%' },
            { id: 'd19', school: 'åœ‹ç«‹æ”¿æ²»å¤§å­¸', dept: 'å‚³æ’­å­¸é™¢ä¸åˆ†ç³»', percent: 3.5, tag: 'ç´„ å‰ 3-4%' },
            { id: 'd07', school: 'åœ‹ç«‹æ”¿æ²»å¤§å­¸', dept: 'æœƒè¨ˆå­¸ç³»', percent: 4.0, tag: 'ç´„ å‰ 4%' },
            { id: 'd08', school: 'åœ‹ç«‹è‡ºç£å¸«å¤§', dept: 'æ•™è‚²å¿ƒç†èˆ‡è¼”å°', percent: 5.5, tag: 'ç´„ å‰ 5-6%' },
            
            // --- ä¸­å …å€é–“ ---
            { id: 'd09', school: 'åœ‹ç«‹ä¸­æ­£å¤§å­¸', dept: 'è²¡ç¶“æ³•å¾‹å­¸ç³»', percent: 7.0, tag: 'ç´„ å‰ 7%' },
            { id: 'd10', school: 'æ±å³å¤§å­¸', dept: 'æ³•å¾‹å­¸ç³»', percent: 9.0, tag: 'ç´„ å‰ 9%' },
            { id: 'd11', school: 'åœ‹ç«‹ä¸­å¤®å¤§å­¸', dept: 'å¤§æ°£ç§‘å­¸å­¸ç³»', percent: 10.0, tag: 'ç´„ å‰ 10%' },
            { id: 'd12', school: 'è¼”ä»å¤§å­¸', dept: 'è‡¨åºŠå¿ƒç†å­¸ç³»', percent: 12.0, tag: 'ç´„ å‰ 12%' },
            { id: 'd13', school: 'ä¸­åœ‹é†«è—¥å¤§å­¸', dept: 'ç‰©ç†æ²»ç™‚å­¸ç³»', percent: 13.0, tag: 'ç´„ å‰ 13%' },
            { id: 'd14', school: 'åœ‹ç«‹è‡ºç£æµ·æ´‹å¤§å­¸', dept: 'å•†èˆ¹å­¸ç³»', percent: 15.0, tag: 'ç´„ å‰ 15%' },
            
            // --- ç†±é–€èˆ‡ç‰¹è‰²å€é–“ ---
            { id: 'd15', school: 'å…ƒæ™ºå¤§å­¸', dept: 'è³‡è¨Šå·¥ç¨‹å­¸ç³»', percent: 16.0, tag: 'ç´„ å‰ 16%' },
            { id: 'd16', school: 'ä¸­åŸå¤§å­¸', dept: 'å®¤å…§è¨­è¨ˆå­¸ç³»', percent: 19.0, tag: 'ç´„ å‰ 19%' },
            { id: 'd17', school: 'åœ‹ç«‹é«˜é›„å¤§å­¸', dept: 'åœŸæœ¨èˆ‡ç’°å¢ƒå·¥ç¨‹', percent: 20.0, tag: 'ç´„ å‰ 20%' },
            { id: 'd18', school: 'æ·¡æ±Ÿå¤§å­¸', dept: 'è³‡è¨Šå·¥ç¨‹å­¸ç³»', percent: 22.0, tag: 'ç´„ å‰ 22%' },
            { id: 'd20', school: 'åœ‹ç«‹æ±è¯å¤§å­¸', dept: 'è«®å•†èˆ‡è‡¨åºŠå¿ƒç†', percent: 26.0, tag: 'ç´„ å‰ 26%' },
            { id: 'd21', school: 'å¯¦è¸å¤§å­¸', dept: 'æœè£è¨­è¨ˆå­¸ç³»', percent: 28.0, tag: 'ç´„ å‰ 28%' },
            { id: 'd22', school: 'åœ‹ç«‹æš¨å—åœ‹éš›å¤§å­¸', dept: 'åœ‹éš›ä¼æ¥­å­¸ç³»', percent: 29.0, tag: 'ç´„ å‰ 29%' },
            { id: 'd23', school: 'é€¢ç”²å¤§å­¸', dept: 'åœŸæœ¨å·¥ç¨‹å­¸ç³»', percent: 30.0, tag: 'ç´„ å‰ 30%' },
            { id: 'd24', school: 'éŠ˜å‚³å¤§å­¸', dept: 'æ–°åª’é«”æš¨å‚³æ’­ç®¡ç†', percent: 31.0, tag: 'ç´„ å‰ 31%' },
            { id: 'd25', school: 'æ±æµ·å¤§å­¸', dept: 'ç¤¾æœƒå·¥ä½œå­¸ç³»', percent: 32.0, tag: 'ç´„ å‰ 32%' },
            { id: 'd26', school: 'åœ‹ç«‹è‡ºæ±å¤§å­¸', dept: 'å¹¼å…’æ•™è‚²å­¸ç³»', percent: 34.0, tag: 'ç´„ å‰ 34%' },
            { id: 'd27', school: 'äºæ´²å¤§å­¸', dept: 'è½åŠ›æš¨èªè¨€æ²»ç™‚', percent: 35.0, tag: 'ç´„ å‰ 35%' },
            { id: 'd28', school: 'éœå®œå¤§å­¸', dept: 'è‹±åœ‹èªæ–‡å­¸ç³»', percent: 36.0, tag: 'ç´„ å‰ 36%' },
            { id: 'd29', school: 'ç¾©å®ˆå¤§å­¸', dept: 'é†«å­¸å½±åƒæš¨æ”¾å°„', percent: 38.0, tag: 'ç´„ å‰ 38%' },
            { id: 'd30', school: 'ä¸­åœ‹æ–‡åŒ–å¤§å­¸', dept: 'å»£å‘Šå­¸ç³»', percent: 40.0, tag: 'ç´„ å‰ 40%' },
        ];

        const TOTAL_ROUNDS = 10;

        // --- Main Component ---
        const StarPlanGame = () => {
            const [gameState, setGameState] = useState('intro'); // intro, playing, finished
            const [round, setRound] = useState(1);
            const [score, setScore] = useState(0);
            const [gamePairs, setGamePairs] = useState([]);
            const [feedback, setFeedback] = useState(null); // null, 'correct', 'wrong'
            const [selectedId, setSelectedId] = useState(null);

            // åˆå§‹åŒ–éŠæˆ²ä¸¦ç”¢ç”Ÿé…å°
            const startGame = () => {
                // 1. è³‡æ–™æ¨™è¨˜èˆ‡æ’åº
                const activeData = RAW_DATA
                    .map(item => ({
                        ...item,
                        type: item.school.startsWith('åœ‹ç«‹') ? 'public' : 'private'
                    }));
                
                // å»ºç«‹åƒè€ƒç”¨çš„æ’åè¡¨
                const sortedReference = [...activeData].sort((a, b) => a.percent - b.percent);

                // 2. å»ºç«‹å¯ç”¨æ± 
                let availableItems = [...sortedReference];
                let pairs = [];
                
                // 3. ç”¢ç”Ÿå°æˆ°çµ„åˆ
                while (pairs.length < TOTAL_ROUNDS && availableItems.length >= 2) {
                    
                    // (A) éš¨æ©Ÿé¸å‡ºç¬¬ä¸€ä½
                    const idx1 = Math.floor(Math.random() * availableItems.length);
                    const item1 = availableItems[idx1];
                    
                    const rank1 = sortedReference.findIndex(d => d.id === item1.id);
                    
                    // (B) å°‹æ‰¾å¯¦åŠ›ç›¸è¿‘çš„å°æ‰‹
                    const searchRange = 6; 
                    
                    const candidates = availableItems.filter(item => {
                        if (item.id === item1.id) return false;
                        const rank2 = sortedReference.findIndex(d => d.id === item.id);
                        return Math.abs(rank1 - rank2) <= searchRange;
                    });

                    let finalCandidates = candidates.length > 0 
                        ? candidates 
                        : availableItems.filter(i => i.id !== item1.id);

                    // (C) å„ªå…ˆå°‹æ‰¾ä¸åŒé«”ç³» (åœ‹ç«‹ vs ç§ç«‹)
                    const oppositeTypeCandidates = finalCandidates.filter(c => c.type !== item1.type);
                    
                    let item2;
                    if (oppositeTypeCandidates.length > 0) {
                        item2 = oppositeTypeCandidates[Math.floor(Math.random() * oppositeTypeCandidates.length)];
                    } else {
                        item2 = finalCandidates[Math.floor(Math.random() * finalCandidates.length)];
                    }
                    
                    // (D) éš¨æ©Ÿæ±ºå®šå·¦å³é †åº
                    pairs.push(Math.random() > 0.5 ? [item1, item2] : [item2, item1]);

                    // (E) å¾æ± ä¸­ç§»é™¤å·²ä½¿ç”¨çš„é …ç›®ï¼Œç¢ºä¿ä¸é‡è¤‡
                    availableItems = availableItems.filter(i => i.id !== item1.id && i.id !== item2.id);
                }

                setGamePairs(pairs);
                setScore(0);
                setRound(1);
                setGameState('playing');
                setFeedback(null);
                setSelectedId(null);
            };

            // è™•ç†é¸æ“‡
            const handleSelect = (selectedItem) => {
                if (feedback) return;

                setSelectedId(selectedItem.id);
                const currentPair = gamePairs[round - 1];
                const otherItem = currentPair.find(item => item.id !== selectedItem.id);

                // åˆ¤æ–·å‹è² ï¼špercent è¶Šå°è¶Šé›£è€ƒ
                const isCorrect = selectedItem.percent <= otherItem.percent;

                if (isCorrect) {
                    setScore(score + 10);
                    setFeedback('correct');
                } else {
                    setFeedback('wrong');
                }

                // å»¶é²å¾Œæ›é¡Œ
                setTimeout(() => {
                    if (round < TOTAL_ROUNDS) {
                        setRound(round + 1);
                        setFeedback(null);
                        setSelectedId(null);
                    } else {
                        setGameState('finished');
                    }
                }, 2500); 
            };

            const getResultComment = () => {
                if (score === 100) return "å®Œç¾ï¼ä½ æ˜¯ç¹æ˜Ÿè½é»å¤§å¸«ï¼";
                if (score >= 80) return "éå¸¸å²å®³ï¼å°å…¬ç§ç«‹çš„è½é»å·®è·å¾ˆæ•éŠ³ï¼";
                if (score >= 60) return "é‚„ä¸éŒ¯ï¼æŒæ¡äº†åŸºæœ¬çš„å­¸æ ¡å±¤ç´šã€‚";
                return "å…¬ç§ç«‹çš„äº¤ç•Œè™•æœ€é›£åˆ¤æ–·ï¼Œå†æŒ‘æˆ°ä¸€æ¬¡å§ï¼";
            };

            // --- ç•«é¢æ¸²æŸ“ ---

            if (gameState === 'intro') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-blue-100 flex items-center justify-center p-4 font-sans">
                        <div className="bg-white max-w-md w-full rounded-2xl shadow-xl p-8 text-center border-4 border-indigo-100">
                            <div className="w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce">
                                <Swords className="w-12 h-12 text-indigo-600" />
                            </div>
                            <h1 className="text-3xl font-bold text-gray-800 mb-2">ç¹æ˜Ÿ PK æ±ºé¬¥</h1>
                            <div className="h-1 w-20 bg-indigo-500 mx-auto mb-6 rounded-full"></div>
                            <p className="text-gray-600 mb-8 leading-relaxed text-lg">
                                ç²¾é¸å¤šå€‹ç†±é–€æ ¡ç³»é€²è¡Œå»æ®ºï¼<br/>
                                æ¯æ¬¡æŒ‘æˆ°å°‡éš¨æ©ŸæŠ½å‡º<span className="text-red-500 font-bold">ä¸åŒ</span>ç§‘ç³»<br/>
                                å„ªå…ˆå®‰æ’<span className="font-bold text-indigo-600">ã€Œå…¬ç«‹ vs ç§ç«‹ã€</span>å°æ±º<br/>
                                è€ƒé©—ä½ å°è½é»çš„ç²¾æº–åˆ¤æ–·ï¼
                            </p>
                            <button 
                                onClick={startGame}
                                className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-xl transition-all transform hover:scale-105 shadow-lg flex items-center justify-center gap-2 text-lg"
                            >
                                <Swords className="w-6 h-6" />
                                é–‹å§‹æŒ‘æˆ° (å…±10é¡Œ)
                            </button>
                        </div>
                    </div>
                );
            }

            if (gameState === 'finished') {
                const sortedRanking = [...RAW_DATA].sort((a, b) => a.percent - b.percent);

                return (
                    <div className="min-h-screen bg-slate-50 p-4 font-sans flex flex-col items-center">
                        <div className="bg-white max-w-3xl w-full rounded-2xl shadow-xl overflow-hidden flex flex-col h-[90vh]">
                            {/* Header */}
                            <div className="bg-indigo-600 p-6 md:p-8 text-center text-white flex-shrink-0">
                                <Trophy className="w-12 h-12 md:w-16 md:h-16 mx-auto mb-4 text-yellow-300" />
                                <h2 className="text-2xl md:text-3xl font-bold mb-2">æŒ‘æˆ°çµæŸ</h2>
                                <div className="text-5xl md:text-6xl font-black mb-2">{score} <span className="text-xl md:text-2xl font-normal">åˆ†</span></div>
                                <p className="opacity-90 text-sm md:text-base">{getResultComment()}</p>
                            </div>

                            {/* Leaderboard */}
                            <div className="p-4 md:p-6 bg-white flex-1 overflow-hidden flex flex-col">
                                <div className="flex items-center gap-2 mb-4 text-gray-800 flex-shrink-0">
                                    <ListOrdered className="w-6 h-6 text-indigo-600" />
                                    <h3 className="text-lg md:text-xl font-bold">ç†±é–€ç§‘ç³» é›£åº¦æ’è¡Œæ¦œ</h3>
                                </div>
                                
                                <div className="overflow-y-auto flex-1 border rounded-lg">
                                    <table className="w-full text-left border-collapse">
                                        <thead className="bg-gray-100 text-gray-600 text-xs md:text-sm uppercase tracking-wider sticky top-0 z-10">
                                            <tr>
                                                <th className="p-3 text-center">æ’å</th>
                                                <th className="p-3">å­¸æ ¡</th>
                                                <th className="p-3">ç§‘ç³»</th>
                                                <th className="p-3 text-right">éŒ„å–æ¨™æº–</th>
                                            </tr>
                                        </thead>
                                        <tbody className="text-sm md:text-base divide-y divide-gray-100">
                                            {sortedRanking.map((item, index) => (
                                                <tr key={item.id} className={`hover:bg-indigo-50 transition-colors ${index < 5 ? 'bg-yellow-50/50' : ''}`}>
                                                    <td className="p-3 text-center w-16">
                                                        {index === 0 && <span className="text-yellow-500 text-xl">ğŸ¥‡</span>}
                                                        {index === 1 && <span className="text-gray-400 text-xl">ğŸ¥ˆ</span>}
                                                        {index === 2 && <span className="text-orange-400 text-xl">ğŸ¥‰</span>}
                                                        {index > 2 && <span className="bg-gray-200 text-gray-600 w-6 h-6 rounded-full inline-flex items-center justify-center text-xs font-bold">{index + 1}</span>}
                                                    </td>
                                                    <td className="p-3 text-gray-800 font-medium">
                                                        {item.school}
                                                        {item.school.startsWith('åœ‹ç«‹') ? 
                                                            <span className="ml-1 text-[10px] bg-blue-100 text-blue-600 px-1 rounded">åœ‹</span> : 
                                                            <span className="ml-1 text-[10px] bg-pink-100 text-pink-600 px-1 rounded">ç§</span>
                                                        }
                                                    </td>
                                                    <td className="p-3 text-indigo-700">{item.dept}</td>
                                                    <td className="p-3 text-gray-600 text-right whitespace-nowrap">{item.tag}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            {/* Action */}
                            <div className="p-4 md:p-6 bg-gray-50 border-t border-gray-100 text-center flex-shrink-0">
                                <button 
                                    onClick={startGame}
                                    className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-transform hover:scale-105 flex items-center justify-center gap-2 mx-auto"
                                >
                                    <RefreshCcw className="w-5 h-5" />
                                    é‡æ–°æŒ‘æˆ°
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Playing State
            const currentPair = gamePairs[round - 1];
            
            return (
                <div className="min-h-screen bg-slate-100 flex flex-col font-sans text-gray-800">
                    {/* Header */}
                    <header className="bg-white shadow-sm sticky top-0 z-10">
                        <div className="max-w-4xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <GraduationCap className="text-indigo-600 w-6 h-6" />
                                <h1 className="font-bold text-lg hidden sm:block">ç¹æ˜Ÿ PK æ±ºé¬¥</h1>
                            </div>
                            <div className="flex items-center gap-6">
                                <div className="text-sm font-medium text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
                                    Round <span className="text-gray-900 font-bold">{round}</span> / {TOTAL_ROUNDS}
                                </div>
                                <div className="flex items-center gap-1 text-indigo-700 font-bold">
                                    <Star className="w-4 h-4 fill-current" />
                                    <span>{score}</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Main Game Area */}
                    <main className="flex-1 max-w-4xl mx-auto w-full p-4 flex flex-col justify-center">
                        
                        <div className="text-center mb-6">
                            <h2 className="text-xl md:text-2xl font-bold text-gray-800">
                                è«‹å•ï¼šå“ªä¸€å€‹ç§‘ç³» <span className="text-indigo-600 underline decoration-wavy decoration-2">å…¥å­¸é–€æª»è¼ƒé«˜</span>ï¼Ÿ
                            </h2>
                            <p className="text-sm text-gray-500 mt-2">ï¼ˆæ ¡æ’ç™¾åˆ†æ¯”è¶Šå°è¶Šé›£è€ƒï¼‰</p>
                        </div>

                        {/* Cards Container */}
                        <div className="flex flex-col md:flex-row gap-4 md:gap-8 items-stretch justify-center relative">
                            
                            {/* VS Badge */}
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10 bg-white rounded-full p-2 shadow-lg hidden md:block">
                                <div className="bg-red-500 text-white font-black text-xl w-12 h-12 flex items-center justify-center rounded-full border-4 border-white">
                                    VS
                                </div>
                            </div>

                            {/* Render Both Cards */}
                            {currentPair && currentPair.map((item) => {
                                const isSelected = selectedId === item.id;
                                const otherItem = currentPair.find(x => x.id !== item.id);
                                const isWinner = item.percent <= otherItem.percent;
                                
                                let cardClass = "bg-white border-2 border-gray-200 hover:border-indigo-300 hover:shadow-xl cursor-pointer";
                                let icon = null;

                                // å›é¥‹ç‹€æ…‹æ¨£å¼
                                if (feedback) {
                                    if (isWinner) {
                                        cardClass = "bg-green-50 border-green-500 shadow-green-200 ring-2 ring-green-200";
                                        icon = <CheckCircle className="w-8 h-8 text-green-500 absolute top-4 right-4" />;
                                    } else if (isSelected && !isWinner) {
                                        cardClass = "bg-red-50 border-red-500 shadow-red-200 opacity-80";
                                        icon = <XCircle className="w-8 h-8 text-red-500 absolute top-4 right-4" />;
                                    } else {
                                        cardClass = "bg-gray-50 border-gray-100 opacity-50 grayscale";
                                    }
                                }

                                return (
                                    <div 
                                        key={item.id}
                                        onClick={() => handleSelect(item)}
                                        className={`
                                            flex-1 relative p-6 md:p-8 rounded-2xl transition-all duration-300 transform 
                                            flex flex-col items-center justify-center text-center gap-3 md:gap-4 min-h-[180px] md:min-h-[280px]
                                            ${cardClass}
                                            ${!feedback && 'hover:-translate-y-1'}
                                        `}
                                    >
                                        {icon}
                                        
                                        <div className="flex items-center gap-2">
                                            <div className="bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-sm font-bold">
                                                {item.school}
                                            </div>
                                            {item.type === 'public' ? 
                                            <span className="text-[10px] bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full font-bold">åœ‹ç«‹</span> :
                                            <span className="text-[10px] bg-pink-100 text-pink-600 px-2 py-0.5 rounded-full font-bold">ç§ç«‹</span>
                                            }
                                        </div>
                                    
                                        <h3 className="text-xl md:text-3xl font-bold text-gray-800">
                                            {item.dept}
                                        </h3>

                                        {/* Reveal Answer */}
                                        <div className={`transition-all duration-500 w-full ${feedback ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`}>
                                            <div className="mt-4 pt-4 border-t border-gray-200 w-full">
                                                <p className="text-xs md:text-sm text-gray-500 uppercase tracking-wider font-bold mb-1">éŒ„å–æ¨™æº–</p>
                                                <p className="text-lg md:text-xl font-bold text-gray-900">{item.tag}</p>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}

                        </div>

                        {/* Feedback Text */}
                        <div className="h-16 mt-6 text-center flex items-center justify-center">
                            {feedback === 'correct' && (
                                <div className="flex items-center gap-2 text-green-600 bg-green-50 px-6 py-3 rounded-full animate-bounce">
                                    <CheckCircle className="w-6 h-6" />
                                    <span className="font-bold text-lg">ç­”å°äº†ï¼</span>
                                </div>
                            )}
                            {feedback === 'wrong' && (
                                <div className="flex items-center gap-2 text-red-600 bg-red-50 px-6 py-3 rounded-full animate-shake">
                                    <XCircle className="w-6 h-6" />
                                    <span className="font-bold text-lg">ç­”éŒ¯äº†ï¼è«‹æŸ¥çœ‹æ•¸æ“šã€‚</span>
                                </div>
                            )}
                        </div>

                    </main>
                    
                    {/* Footer */}
                    <footer className="bg-white border-t border-gray-100 text-gray-400 text-xs text-center py-4">
                        <p>è³‡æ–™åƒ…ä¾›éŠæˆ²åƒè€ƒï¼Œå¯¦éš›æ¨™æº–è«‹ä¾ç•¶å¹´åº¦ç¹æ˜Ÿæ¨è–¦ç°¡ç« ç‚ºæº–ã€‚</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<StarPlanGame />);
    </script>
</body>
</html>
