<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>傳播學院分類帽</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts (Noto Sans TC) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen text-gray-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons Components ---
        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const icons = {
            Search: <path d="m21 21-4.3-4.3M11 17a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"/>,
            Target: <><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/><path d="M8.5 8.5v.01"/><path d="M16 12a10 10 0 1 0-2 18"/><path d="M12 16a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z"/></>,
            Eye: <><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></>,
            Brain: <><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></>,
            MessageCircle: <path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/>,
            Aperture: <><circle cx="12" cy="12" r="10"/><path d="m14.31 8 5.74 9.94"/><path d="M9.69 8h11.48"/><path d="m7.38 12 5.74-9.94"/><path d="M9.69 16 3.95 6.06"/><path d="M14.31 16H2.83"/><path d="m16.62 12-5.74 9.94"/></>,
            Compass: <><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></>,
            Zap: <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>,
            Feather: <><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" x2="2" y1="8" y2="22"/><line x1="17.5" x2="9" y1="15" y2="15"/></>,
            Lightbulb: <><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2.4 1.5-3.8 0-3.2-2.8-5.7-6-5.7s-6 2.5-6 5.7c0 1.4.5 2.8 1.5 3.8.8.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></>,
            Mic: <><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></>,
            Users: <><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>,
            Heart: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>,
            Map: <><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" x2="9" y1="3" y2="18"/><line x1="15" x2="15" y1="6" y2="21"/></>,
            RefreshCw: <><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></>,
            ChevronRight: <path d="m9 18 6-6-6-6"/>,
            Key: <><circle cx="7.5" cy="15.5" r="5.5"/><path d="m21 2-9.6 9.6"/><path d="m15.5 7.5 3 3L22 7l-3-3"/></>,
            Anchor: <><circle cx="12" cy="5" r="3"/><line x1="12" x2="12" y1="22" y2="8"/><path d="M5 12H2a10 10 0 0 0 20 0h-3"/></>
        };

        const renderIcon = (name, className) => <Icon path={icons[name]} className={className} />;

        const CommunicationMajorSorter = () => {
            const [step, setStep] = useState('intro'); // intro, quiz, analyzing, result
            const [currentQ, setCurrentQ] = useState(0);
            const [scores, setScores] = useState({ news: 0, ad: 0, rtf: 0 });
            const [shuffledQuestions, setShuffledQuestions] = useState([]);

            const rawQuestions = [
                {
                    id: 1,
                    question: "眼前有一幅看不懂的抽象畫，你的第一個念頭是？",
                    options: [
                        { text: "這幅畫想要表達什麼？畫家的背景是誰？", scores: { news: 3, ad: 1, rtf: 1 }, iconName: "Search" },
                        { text: "這幅畫掛在哪裡最適合？誰會想買它？", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Target" },
                        { text: "盯著它的顏色和線條，單純感受它帶給我的情緒。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Eye" }
                    ]
                },
                {
                    id: 2,
                    question: "朋友和你分享一個他做的奇怪夢境，你會？",
                    options: [
                        { text: "幫他分析夢裡的象徵，試著解釋這反映了他最近什麼壓力。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Brain" },
                        { text: "告訴他：「這代表你快發財了！」（隨便說個好聽的讓他開心）。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "MessageCircle" },
                        { text: "閉上眼想像那個夢境的畫面，覺得那個場景好酷。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Aperture" }
                    ]
                },
                {
                    id: 3,
                    question: "去一個陌生的城市旅行，你最不能接受哪種情況？",
                    options: [
                        { text: "迷路，而且完全搞不清楚東南西北，沒有地圖。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Compass" },
                        { text: "去的地方很無聊，沒有任何好玩或值得打卡分享的點。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Zap" },
                        { text: "風景很醜，到處都是灰濛濛的水泥牆，沒有美感。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Feather" }
                    ]
                },
                {
                    id: 4,
                    question: "如果要把一段記憶永久保存下來，你希望形式是？",
                    options: [
                        { text: "一本詳細的筆記，精確記錄時間、地點和發生的事。", scores: { news: 3, ad: 0, rtf: 0 }, iconName: "Search" },
                        { text: "一個精緻的時光膠囊，打開時會給未來的自己一個驚喜。", scores: { news: 0, ad: 3, rtf: 2 }, iconName: "Lightbulb" },
                        { text: "一段錄音或影片，能讓我重溫當時的空氣、聲音和光線。", scores: { news: 1, ad: 0, rtf: 3 }, iconName: "Mic" }
                    ]
                },
                {
                    id: 5,
                    question: "在團隊合作中，當大家意見不合僵持不下，你會？",
                    options: [
                        { text: "把大家的觀點列出來，找出邏輯矛盾點，看誰最有道理。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Brain" },
                        { text: "觀察誰是關鍵意見領袖，試著說服他，或提出折衷方案來破冰。", scores: { news: 1, ad: 3, rtf: 0 }, iconName: "Users" },
                        { text: "覺得氣氛太僵了，試著放個音樂或開個玩笑來轉換氛圍。", scores: { news: 0, ad: 2, rtf: 3 }, iconName: "Heart" }
                    ]
                },
                {
                    id: 6,
                    question: "你覺得什麼樣的人最有魅力？",
                    options: [
                        { text: "博學多聞，說話有憑有據，從不信口開河的人。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Search" },
                        { text: "幽默風趣，總能輕易帶動氣氛，成為全場焦點的人。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Zap" },
                        { text: "氣質獨特，這人本身就像一部電影，充滿故事感的人。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Feather" }
                    ]
                },
                {
                    id: 7,
                    question: "如果世界末日來臨，只能帶走一樣東西，你會選？",
                    options: [
                        { text: "百科全書或硬碟，保存人類的知識與歷史。", scores: { news: 3, ad: 0, rtf: 0 }, iconName: "Brain" },
                        { text: "通訊器材，確保我還能聯繫上倖存者並組織他們。", scores: { news: 1, ad: 3, rtf: 0 }, iconName: "Target" },
                        { text: "樂器或畫具，即使在末日也要保有心靈的寄託。", scores: { news: 0, ad: 0, rtf: 3 }, iconName: "Aperture" }
                    ]
                },
                {
                    id: 8,
                    question: "你比較擅長處理哪種「不確定性」？",
                    options: [
                        { text: "複雜的謎團：透過線索拼湊出真相。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Compass" },
                        { text: "人心難測：預測對方的反應並引導他們。", scores: { news: 1, ad: 3, rtf: 1 }, iconName: "Lightbulb" },
                        { text: "創作瓶頸：在空白中無中生有，創造出作品。", scores: { news: 0, ad: 2, rtf: 3 }, iconName: "Feather" }
                    ]
                },
                {
                    id: 9,
                    question: "看電影時，哪個瞬間最讓你出戲（無法投入）？",
                    options: [
                        { text: "劇情出現巨大的邏輯漏洞，根本不合理。", scores: { news: 3, ad: 0, rtf: 1 }, iconName: "Search" },
                        { text: "置入性行銷太明顯，或台詞說教感太重。", scores: { news: 1, ad: 3, rtf: 0 }, iconName: "Target" },
                        { text: "演員演技太爛，或是特效假到讓人尷尬。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Eye" }
                    ]
                },
                {
                    id: 10,
                    question: "最後，你認為「話語」的最大力量在於？",
                    options: [
                        { text: "揭露：讓被隱藏的事物顯現。", scores: { news: 3, ad: 0, rtf: 1 }, iconName: "Mic" },
                        { text: "煽動：激發人們採取行動。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Zap" },
                        { text: "感動：觸摸靈魂深處的柔軟。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Heart" }
                    ]
                },
                {
                    id: 11,
                    question: "如果要在搶劫電影中扮演一個角色，你會是？",
                    options: [
                        { text: "情報專家：負責研究藍圖、破解保全系統邏輯。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Brain" },
                        { text: "談判專家：負責詐騙警衛、控制人質心理。", scores: { news: 1, ad: 3, rtf: 1 }, iconName: "Users" },
                        { text: "偽裝大師：負責製作假證件、易容、營造假象。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Aperture" }
                    ]
                },
                {
                    id: 12,
                    question: "送禮物給重要的人，你的挑選標準是？",
                    options: [
                        { text: "實用性：他最近剛好缺少的東西，解決他的問題。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Search" },
                        { text: "象徵性：這禮物代表了我們之間的關係，能說服他我重視他。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Heart" },
                        { text: "獨特性：最好是手工做的，或是全世界獨一無二的藝術品。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Feather" }
                    ]
                },
                {
                    id: 13,
                    question: "你理想中的工作環境長什麼樣子？",
                    options: [
                        { text: "像指揮中心，有多個螢幕監控資訊，井然有序。", scores: { news: 3, ad: 0, rtf: 1 }, iconName: "Compass" },
                        { text: "開放式空間，大家隨時可以丟出點子互相激盪。", scores: { news: 0, ad: 3, rtf: 2 }, iconName: "Lightbulb" },
                        { text: "燈光昏暗有氣氛的工作室，放著好聽的音樂。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Mic" }
                    ]
                },
                {
                    id: 14,
                    question: "如果可以擁有一把傳說中的武器，你會選？",
                    options: [
                        { text: "真理之劍：能斬斷一切虛假與幻象。", scores: { news: 3, ad: 0, rtf: 0 }, iconName: "Search" },
                        { text: "魅惑權杖：能指揮千軍萬馬聽你號令。", scores: { news: 0, ad: 3, rtf: 1 }, iconName: "Target" },
                        { text: "造物神筆：畫出來的東西都會變成真的。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Feather" }
                    ]
                },
                {
                    id: 15,
                    question: "你覺得哪種「自由」對你來說最重要？",
                    options: [
                        { text: "知的自由：沒有審查，沒有秘密被隱瞞。", scores: { news: 3, ad: 1, rtf: 0 }, iconName: "Eye" },
                        { text: "選擇的自由：有能力去影響結果，不被命運擺佈。", scores: { news: 0, ad: 3, rtf: 0 }, iconName: "Zap" },
                        { text: "表達的自由：能隨心所欲展現內心的想像世界。", scores: { news: 0, ad: 1, rtf: 3 }, iconName: "Aperture" }
                    ]
                }
            ];

            const shuffleArray = (array) => {
                const newArray = [...array];
                for (let i = newArray.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                }
                return newArray;
            };

            const startQuiz = () => {
                const randomizedQuestions = rawQuestions.map(q => ({
                    ...q,
                    options: shuffleArray(q.options)
                }));
                setShuffledQuestions(randomizedQuestions);
                setScores({ news: 0, ad: 0, rtf: 0 });
                setCurrentQ(0);
                setStep('quiz');
            };

            const handleAnswer = (optionScores) => {
                setScores(prev => ({ 
                    news: prev.news + optionScores.news, 
                    ad: prev.ad + optionScores.ad, 
                    rtf: prev.rtf + optionScores.rtf 
                }));
                
                if (currentQ < shuffledQuestions.length - 1) {
                    setCurrentQ(prev => prev + 1);
                } else {
                    setStep('analyzing');
                    setTimeout(() => setStep('result'), 2000);
                }
            };

            const getWinner = () => {
                const scoreArray = [
                    { type: 'news', val: scores.news },
                    { type: 'ad', val: scores.ad },
                    { type: 'rtf', val: scores.rtf }
                ];
                // Sort descending
                scoreArray.sort((a, b) => b.val - a.val);
                
                const top1 = scoreArray[0];
                const top2 = scoreArray[1];
                const top3 = scoreArray[2];

                // Check for Balanced: if the gap between 1st and 3rd place is small (e.g. <= 4 points), it's balanced.
                if ((top1.val - top3.val) <= 4) return 'balanced';

                // Return combination string: e.g. "news_ad"
                return `${top1.type}_${top2.type}`;
            };

            const results = {
                news_ad: {
                    title: "資訊策展人 (The Info-Curator)",
                    dept: "基因組成：新聞系 60% + 廣告系 40%",
                    keywords: "邏輯求真、行銷包裝、策略溝通",
                    desc: "你不是傳統的記者，你是懂得「說故事」的數據專家。你有新聞人的求真邏輯，也有廣告人的行銷手腕。你擅長處理複雜、生硬的資訊，並將其轉化為大眾愛看、易懂的內容。你是現代媒體最稀缺的混血人才。",
                    fit: "你適合去需要將硬知識「軟化」的領域。",
                    career: "數據新聞記者、品牌公關、內容行銷經理、科普YouTuber、智庫分析師。",
                    color: "bg-teal-600",
                    bg: "bg-teal-50"
                },
                ad_news: {
                    title: "輿論操盤手 (The Spin Doctor)",
                    dept: "基因組成：廣告系 60% + 新聞系 40%",
                    keywords: "洞察人心、議題設定、危機處理",
                    desc: "你深知「事實」是可以被篩選和排列的。與單純的廣告人不同，你更重視證據和邏輯；與單純的新聞人不同，你清楚每個訊息背後的目的。你擅長利用真實的素材來引導公眾視聽，是天生的公關與危機處理專家。",
                    fit: "你適合在充滿爭議或需要高度策略的環境中工作。",
                    career: "危機處理顧問、政治公關、企業發言人、議題策展人、競選團隊核心。",
                    color: "bg-indigo-600",
                    bg: "bg-indigo-50"
                },
                news_rtf: {
                    title: "紀實影像家 (The Realist Creator)",
                    dept: "基因組成：新聞系 60% + 廣電系 40%",
                    keywords: "真實記錄、鏡頭語言、深度報導",
                    desc: "對你來說，真實比小說更精彩。你喜歡用影像說話，但你的鏡頭永遠對準現實世界，而非虛構的幻想。你不滿足於文字的蒼白，也不喜歡過度的特效包裝。你致力於用充滿美感的畫面，去揭露社會的真實面貌。",
                    fit: "你適合用影像為弱勢發聲，或記錄時代的變遷。",
                    career: "紀錄片導演、新聞專題製作人、戰地攝影師、人文紀實攝影師。",
                    color: "bg-cyan-700",
                    bg: "bg-cyan-50"
                },
                rtf_news: {
                    title: "社會觀察家 (The Social Auteur)",
                    dept: "基因組成：廣電系 60% + 新聞系 40%",
                    keywords: "社會批判、獨特觀點、影音創作",
                    desc: "你的創作不只是為了美，更是為了傳達某種社會觀點或批判。你的作品通常「言之有物」，不會流於空泛的娛樂。你擅長用隱喻、象徵的手法來探討嚴肅的社會議題，讓觀眾在被感動的同時，也被迫思考。",
                    fit: "你適合創作具有思想深度與社會影響力的作品。",
                    career: "獨立電影導演、社會議題YouTuber、Podcast製作人、深度專欄作家。",
                    color: "bg-emerald-600",
                    bg: "bg-emerald-50"
                },
                ad_rtf: {
                    title: "創意總監 (The Creative Director)",
                    dept: "基因組成：廣告系 60% + 廣電系 40%",
                    keywords: "商業美學、市場敏銳、視覺衝擊",
                    desc: "你懂市場，也懂美學。這是一組非常強勢的組合。你的創意不僅天馬行空，還能精準落地，轉換成商業價值。你知道什麼樣的畫面能賣錢，什麼樣的節奏能留住觀眾。你是商業與藝術之間的完美翻譯官。",
                    fit: "你適合在商業體系中發揮創意，引領潮流。",
                    career: "廣告導演、創意總監、品牌形象顧問、時尚編輯、MV導演。",
                    color: "bg-orange-500",
                    bg: "bg-orange-50"
                },
                rtf_ad: {
                    title: "流量煉金術師 (The Viral Hitmaker)",
                    dept: "基因組成：廣電系 60% + 廣告系 40%",
                    keywords: "感官體驗、觀眾心理、爆款製造",
                    desc: "你對感官節奏有極強的直覺，同時也精準掌握觀眾想要看什麼。你天生知道如何製造「爆款」。你不一定追求深奧的藝術哲理，但你絕對知道如何在三秒鐘內抓住眼球，讓內容在網路上瘋傳。",
                    fit: "你適合在新媒體與短影音的戰場上攻城掠地。",
                    career: "短影音創作者、社群影音總監、直播策劃、娛樂節目製作人。",
                    color: "bg-pink-600",
                    bg: "bg-pink-50"
                },
                balanced: {
                    title: "荒野開拓者 (The Pathfinder)",
                    dept: "基因組成：各項數值均衡發展",
                    keywords: "全能潛力、不甘平凡、跨域整合",
                    desc: "你的測驗結果顯示你的能力非常平均，這代表現有的單一科系框架可能都無法完全滿足你。與其在熱門的領域（如廣告或拍片）跟隨大流，建議你選擇一條「人少」的路，去創造屬於你的「混血」專業。",
                    fit: "你應該嘗試去結合最難結合的東西。",
                    career: "獨立媒體創辦人、跨領域專案製作人、社會企業家、實驗藝術家。",
                    color: "bg-gray-700",
                    bg: "bg-gray-100"
                }
            };

            const winnerKey = step === 'result' ? getWinner() : 'news_ad';
            const resultData = results[winnerKey] || results['balanced'];
            const maxScore = 45;

            return (
                <div className="flex items-center justify-center p-4 min-h-screen">
                    <div className="max-w-2xl w-full bg-white rounded-3xl shadow-xl overflow-hidden min-h-[600px] flex flex-col">
                        
                        {/* Header */}
                        <div className="bg-gray-900 p-6 text-white flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                {renderIcon('Map', 'w-6 h-6 text-pink-400')}
                                <h1 className="text-xl font-bold tracking-wide">傳播學院分類帽</h1>
                            </div>
                            {step === 'quiz' && (
                                <div className="text-xs font-mono text-gray-400">
                                    SCANNING... {Math.round(((currentQ + 1) / shuffledQuestions.length) * 100)}%
                                </div>
                            )}
                        </div>

                        {/* Content Area */}
                        <div className="flex-1 p-8 flex flex-col justify-center">
                            
                            {step === 'intro' && (
                                <div className="text-center animate-fade-in">
                                    <div className="w-24 h-24 bg-gray-100 rounded-full mx-auto mb-6 flex items-center justify-center border-4 border-gray-200">
                                        {renderIcon('Brain', 'w-12 h-12 text-gray-800')}
                                    </div>
                                    <h2 className="text-3xl font-bold mb-4">歡迎來到分類儀式</h2>
                                    <p className="text-gray-600 mb-8 leading-relaxed text-lg">
                                        在傳播的領域裡，<br/>
                                        有些人擅長看穿謊言，<br/>
                                        有些人擅長編織夢境，<br/>
                                        有些人擅長操控人心。<br/>
                                        <br/>
                                        這裡沒有科系名稱，只有關於你靈魂本質的拷問。<br/>
                                        回答 15 道情境題，找出你原本屬於哪裡。
                                    </p>
                                    <button 
                                        onClick={startQuiz}
                                        className="bg-black text-white px-10 py-4 rounded-full font-bold hover:bg-gray-800 transition-all flex items-center gap-2 mx-auto shadow-lg transform hover:scale-105"
                                    >
                                        戴上分類帽 {renderIcon('ChevronRight', 'w-5 h-5')}
                                    </button>
                                </div>
                            )}

                            {step === 'quiz' && shuffledQuestions.length > 0 && (
                                <div className="animate-fade-in w-full">
                                    <div className="mb-8">
                                        <span className="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 block">Question {String(currentQ + 1).padStart(2, '0')} / 15</span>
                                        <h3 className="text-2xl font-bold text-gray-900 leading-tight">
                                            {shuffledQuestions[currentQ].question}
                                        </h3>
                                    </div>

                                    <div className="space-y-4">
                                        {shuffledQuestions[currentQ].options.map((opt, idx) => (
                                            <button
                                                key={idx}
                                                onClick={() => handleAnswer(opt.scores)}
                                                className="w-full text-left p-5 rounded-xl border border-gray-200 hover:border-black hover:bg-gray-50 transition-all group flex items-start gap-4"
                                            >
                                                <div className="mt-1 text-gray-400 group-hover:text-black transition-colors">
                                                    {renderIcon(opt.iconName, 'w-5 h-5')}
                                                </div>
                                                <span className="text-lg text-gray-700 group-hover:text-black font-medium">
                                                    {opt.text}
                                                </span>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {step === 'analyzing' && (
                                <div className="text-center animate-pulse">
                                    <div className="mx-auto mb-6 w-16 h-16 flex items-center justify-center">
                                        {renderIcon('RefreshCw', 'w-16 h-16 text-gray-800 animate-spin')}
                                    </div>
                                    <h3 className="text-2xl font-bold text-gray-800">分類帽正在思考...</h3>
                                    <p className="text-gray-500 mt-2">分析你的潛意識路徑...</p>
                                </div>
                            )}

                            {step === 'result' && (
                                <div className="animate-fade-in h-full flex flex-col">
                                    <div className={`flex-1 rounded-2xl p-8 ${resultData.bg} mb-6 border-2 border-opacity-10 border-black shadow-inner`}>
                                        <div className="flex justify-between items-start mb-4">
                                            <span className={`inline-block px-4 py-1 rounded-full text-white text-xs font-bold ${resultData.color}`}>
                                                SORTING RESULT
                                            </span>
                                            {winnerKey === 'balanced' && renderIcon('Compass', 'w-6 h-6 text-gray-600')}
                                        </div>
                                        
                                        <h2 className="text-3xl font-bold text-gray-900 mb-2">{resultData.title}</h2>
                                        <h3 className="text-xl text-gray-700 mb-6 font-mono border-b border-black border-opacity-10 pb-4 inline-block">
                                            {resultData.dept}
                                        </h3>
                                        
                                        <div className="flex flex-wrap gap-2 mb-6">
                                            {resultData.keywords.split('、').map((k, i) => (
                                                <span key={i} className="bg-white px-3 py-1 rounded-lg border border-gray-200 text-sm font-bold text-gray-600 shadow-sm">
                                                    #{k}
                                                </span>
                                            ))}
                                        </div>

                                        <p className="text-gray-800 leading-relaxed mb-8 text-lg font-medium">
                                            {resultData.desc}
                                        </p>

                                        <div className="grid gap-4">
                                            <div className="bg-white bg-opacity-70 p-4 rounded-xl border border-white">
                                                <h4 className="font-bold text-gray-900 mb-2 flex items-center gap-2 text-sm uppercase tracking-wide">
                                                    {renderIcon('Key', 'w-4 h-4')} 為什麼適合你？
                                                </h4>
                                                <p className="text-sm text-gray-600">{resultData.fit}</p>
                                            </div>
                                            
                                            <div className="bg-white bg-opacity-70 p-4 rounded-xl border border-white">
                                                <h4 className="font-bold text-gray-900 mb-2 flex items-center gap-2 text-sm uppercase tracking-wide">
                                                    {renderIcon('Anchor', 'w-4 h-4')} 未來定位
                                                </h4>
                                                <p className="text-sm text-gray-600">{resultData.career}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="opacity-70 hover:opacity-100 transition-opacity">
                                        <div className="flex gap-1 h-2 w-full rounded-full overflow-hidden mb-1">
                                            <div className="bg-blue-500 transition-all duration-1000" style={{ width: `${(scores.news/maxScore)*100}%` }}></div>
                                            <div className="bg-yellow-500 transition-all duration-1000" style={{ width: `${(scores.ad/maxScore)*100}%` }}></div>
                                            <div className="bg-purple-500 transition-all duration-1000" style={{ width: `${(scores.rtf/maxScore)*100}%` }}></div>
                                        </div>
                                        <div className="flex justify-between text-[10px] text-gray-400 font-mono px-1">
                                            <span>News: {scores.news}</span>
                                            <span>Ads: {scores.ad}</span>
                                            <span>RTF: {scores.rtf}</span>
                                        </div>
                                    </div>

                                    <button 
                                        onClick={() => {
                                            setStep('intro');
                                            setScores({ news: 0, ad: 0, rtf: 0 });
                                            setCurrentQ(0);
                                        }}
                                        className="w-full py-4 mt-4 text-gray-500 hover:bg-gray-100 hover:text-black rounded-xl transition-all flex items-center justify-center gap-2 font-bold"
                                    >
                                        {renderIcon('RefreshCw', 'w-4 h-4')} 重新分類
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CommunicationMajorSorter />);
    </script>
</body>
</html>
